<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–ú–∞–≥–∞–∑–∏–Ω</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
body{font-family:Arial;margin:0;background:#f4f6f8}
header{padding:12px;background:#fff;font-weight:700}
.tabs{display:flex;gap:10px;padding:10px;overflow:auto}
.tab{background:#e2e8f0;padding:8px 12px;border-radius:10px;cursor:pointer;white-space:nowrap}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;padding:10px;padding-bottom:170px}
.card{background:#fff;padding:10px;border-radius:12px}
.price{font-weight:bold;margin:6px 0}
.btn{width:100%;padding:10px;border:0;border-radius:10px;background:#3b82f6;color:#fff;margin-top:6px;cursor:pointer}
.cart{position:fixed;bottom:0;left:0;right:0;background:#fff;padding:10px;border-top:1px solid #ccc}
.small{font-size:12px;color:#64748b;margin-top:6px}
</style>
</head>

<body>
<header>–ú–∞–≥–∞–∑–∏–Ω</header>

<div class="tabs">
  <div class="tab" onclick="load('waka6000')">WAKA 6000</div>
  <div class="tab" onclick="load('waka8000')">WAKA 8000</div>
  <div class="tab" onclick="load('waka10000')">WAKA 10000</div>
</div>

<div class="grid" id="products"></div>

<div class="cart">
  <div>üõí –í –∫–æ—Ä–∑–∏–Ω–µ: <span id="count">0</span> ¬∑ –ò—Ç–æ–≥–æ: <span id="total">0</span> ‚Ç∏</div>

  <input id="address" placeholder="–í–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ (–≥–æ—Ä–æ–¥, —É–ª–∏—Ü–∞, –¥–æ–º, –∫–≤.)"
         style="width:100%;padding:10px;margin-top:8px;border-radius:10px;border:1px solid #ccc">

  <button class="btn" onclick="checkout()">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>

  <div class="small">–ü–æ—Å–ª–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑ –æ—Ç–ø—Ä–∞–≤–∏—Ç—Å—è –∞–¥–º–∏–Ω—É –≤ Telegram.</div>
</div>

<script>
const tg = window.Telegram?.WebApp;
if (tg) tg.ready();

/*
–ö–æ—Ä–∑–∏–Ω–∞: –æ–±—ä–µ–∫—Ç –ø–æ –∫–ª—é—á—É —Ç–æ–≤–∞—Ä–∞
cart[key] = { title, model, flavor, price, qty }
*/
let cart = {};

// –ö–∞—Ç–∞–ª–æ–≥ –≤–∫—É—Å–æ–≤
const data = {
  waka6000: [
    "–ö–ª—É–±–Ω–∏–∫–∞ –≤–∏–Ω–æ–≥—Ä–∞–¥",
    "–ì–∞–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∏—à–Ω—è –ª–∞–π–º",
    "–ú—è—Ç–Ω–∞—è —á–µ—Ä–Ω–∏–∫–∞",
    "–Ø–≥–æ–¥–Ω—ã–π –º–∏–∫—Å",
    "–ö–∏—Å–ª–∞—è –∫–ª—É–±–Ω–∏–∫–∞",
    "–í–∏–Ω–æ–≥—Ä–∞–¥–Ω—ã–π –º–æ—Ä—Å",
    "–ß—É–ø—Å –∫–ª—É–±–Ω–∏–∫–∞ –º–∞–ª–∏–Ω–∞",
    "–ê—Ä–±—É–∑–Ω–∞—è –∂–≤–∞—á–∫–∞"
  ],
  waka8000: [
    "–ê—Ä–±—É–∑",
    "–ú—è—Ç–∞",
    "–í–∏—à–Ω—è",
    "–ß–µ—Ä–Ω–∏–∫–∞ –∫–ª—é–∫–≤–∞ –≤–∏—à–Ω—è",
    "–°–∞–∫—É—Ä–∞ –≤–∏–Ω–æ–≥—Ä–∞–¥",
    "–ö–ª—É–±–Ω–∏–∫–∞ –º–∞–ª–∏–Ω–∞",
    "–õ–∏–º–æ–Ω–Ω–∞—è –∫–æ–ª–∞",
    "–ú–æ—Ä—Å–∫–∞—è —Å–æ–ª—å –ª–∏–º–æ–Ω"
  ],
  waka10000: [
    "–ö–ª—É–±–Ω–∏–∫–∞ –±–∞–Ω–∞–Ω",
    "–°–≤–µ–∂–∞—è –º—è—Ç–∞",
    "–°–∞–∫—É—Ä–∞ –≤–∏–Ω–æ–≥—Ä–∞–¥",
    "–ß–µ—Ä–Ω–∞—è –≤–∏—à–Ω—è",
    "–ß–µ—Ä–Ω–∏–∫–∞ –∫–ª—é–∫–≤–∞ –≤–∏—à–Ω—è",
    "–ñ–µ–≤–∞—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∑–∏–Ω–∫–∏",
    "–ì–∞–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —è–≥–æ–¥–∞ –∫–∏—Å–ª–∞—è",
    "–ú–∏—Å—Ç–µ—Ä –±–ª—é",
    "–Ø–±–ª–æ—á–Ω—ã–π –≤–∑—Ä—ã–≤",
    "–ê—Ä–±—É–∑",
    "–í–∏–Ω–æ–≥—Ä–∞–¥ —è–±–ª–æ–∫–æ",
    "–í–∏—à–Ω—ë–≤–æ —è–≥–æ–¥–Ω—ã–π –ª—ë–¥"
  ]
};

// –¶–µ–Ω—ã –ø–æ –º–æ–¥–µ–ª–∏
function getPrice(cat){
  if(cat === "waka6000") return 9990;
  if(cat === "waka8000") return 10990;
  if(cat === "waka10000") return 12990;
  return 0;
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á—ë—Ç—á–∏–∫–æ–≤ –∫–æ—Ä–∑–∏–Ω—ã
function updateCartUI(){
  const items = Object.values(cart);
  const totalQty = items.reduce((s, it) => s + it.qty, 0);
  const totalSum = items.reduce((s, it) => s + it.qty * it.price, 0);

  document.getElementById("count").innerText = totalQty;
  document.getElementById("total").innerText = totalSum;
}

// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É
function addToCart(item){
  const key = item.key;
  if(cart[key]) {
    cart[key].qty += 1;
  } else {
    cart[key] = { ...item, qty: 1 };
  }
  updateCartUI();
}

// –†–µ–Ω–¥–µ—Ä —Ç–æ–≤–∞—Ä–æ–≤
function load(cat){
  const box = document.getElementById("products");
  box.innerHTML = "";

  const price = getPrice(cat);
  const model = cat.replace("waka",""); // 6000/8000/10000

  data[cat].forEach((flavor, index) => {
    const title = `WAKA ${model}`;
    const key = `${cat}-${index}`;

    box.innerHTML += `
      <div class="card">
        <div>${title} ‚Äî ${flavor}</div>
        <div class="price">‚Ç∏${price}</div>
        <button class="btn" onclick="addToCart({
          key: '${key}',
          title: '${title}',
          model: '${model}',
          flavor: '${flavor}',
          price: ${price}
        })">–í –∫–æ—Ä–∑–∏–Ω—É</button>
      </div>
    `;
  });
}

// –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ (–æ—Ç–ø—Ä–∞–≤–∫–∞ JSON –≤ –±–æ—Ç–∞)
function checkout(){
  if(!tg){
    alert("–û—Ç–∫—Ä–æ–π –º–∞–≥–∞–∑–∏–Ω –≤–Ω—É—Ç—Ä–∏ Telegram");
    return;
  }

  const items = Object.values(cart);
  if(items.length === 0){
    alert("–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞");
    return;
  }

  const address = document.getElementById("address").value.trim();
  if(address.length < 5){
    alert("–í–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏");
    return;
  }

  const total = items.reduce((s, it) => s + it.qty * it.price, 0);

  const order = {
    type: "order",
    address: address,
    items: items.map(it => ({
      title: it.title,
      model: it.model,
      flavor: it.flavor,
      price: it.price,
      qty: it.qty
    })),
    total: total
  };

  tg.sendData(JSON.stringify(order));
  tg.close();
}

// —Å—Ç–∞—Ä—Ç–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è
load('waka6000');
updateCartUI();
</script>
</body>
</html>
